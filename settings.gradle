/*
 * This file was generated by the Gradle 'init' task.
 *
 * The settings file is used to specify which projects to include in your build.
 *
 * Detailed information about configuring a multi-project build in Gradle can be found
 * in the user manual at https://docs.gradle.org/6.5.1/userguide/multi_project_builds.html
 */
rootProject.name = 'spring-boot-learning'

include(":template-engine:thymeleaf:AdminLTE_CN")

// 忽略的目录，如果有不想自动注册的目录也可以放进来
def ignoreDirs = [
        ".gradle",
        ".idea",
        ".git",
        "gradle",
        "logs",
        "buildSrc",
        "build",
        "out",
        "doc",
        "libs",
        "db",
        "src"
]

autoRegisterModule(settingsDir, ignoreDirs)

// 自动注册当前所有子目录下的模块
def autoRegisterModule(def dir, def ignoreDirs = []) {
    def moduleSymbol = ["build.gradle", "build.gradle.kts"]

    if (dir.isDirectory() && !ignoreDirs.contains(dir.getName())) {
        dir.eachFile { f ->
            autoRegisterModule(f, ignoreDirs)
        }
    } else if (!dir.isDirectory() && moduleSymbol.contains(dir.getName())) {
        // 相对目录
        def path = dir.getParentFile()
                .getPath()
                .replace("$rootDir", "")
        // 排除根目录
        if (path.isEmpty()) return
        // 组装模块
        def modelName = path.replace(File.separator, ":")
        // 是模块，可以注册
        println "include(\"$modelName\")"
//        include("$modelName")
    }
}
